Progress Tracking:
X    1. Game and Form basic structure
X    2. Game and resource functions
X    3. Resource tree and preview window
X    4. Game menu functions
X    5. Resource menu functions
X    6. Tools menu functions
X    7. Logic Editor
X    8. Status Bar
X    9. Character Map
X   10. Snippets Editor
X   11. Global Defines Editor
X   12. Reserved Defines Editor
X   13. Object Editor
X   14. Word Editor
X   15. Palette Editor
X   16. Picture Editor
X   17. View Editor
X   18. Sound Editor
X   19. Layout Editor
X   20. Menu Editor
X   21. Text Screen Editor
O   22. Help Integration
    23. BETA TESTING
      


Miscellaneous Notes
===========================================================================================================
      




WINAGI EXCEPTIONS: 
===========================================================================================================
CLASS             FUNCTION:                 NUMBER:   DESCRIPTION
AGIGame           Compile                   510       missing directory
AGIGame           GameID/set                503       file access error while renaming v3  DIR/VOL files
AGIGame           InterpreterVersion/set    518       new value is not numeric
AGIGame           InterpreterVersion/set    518       new value is invalid major version
AGIGame           InterpreterVersion/set    506       new value is invalid minor version
AGIGame           NewGame                   535       new game directory has existing WAG file
AGIGame           NewGame                   536       new game directory has existing AGI game files
AGIGame           NewGame                   518       new intver is invalid major version
AGIGame           NewGame                   506       new intver is invalid minor version
AGIGame           NewGame                   527       no WAG files in this directory
AGIGame           NewGame                   543       template (source) directory has multiple WAG files
AGIGame           NewGame                   544       template (source) missing resdir
AGIGame           NewGame                   533       file access error while copying template to new directory
AGIGame           NewGame                   545       unable to copy resdir directory
AGIGame           NewGame                   546       unable to create wag file
AGIGame           NewGame                   534       unable to open game in new folder(pass-through FinishGameLoad)
AGIGame           OpenGameDIR               504       directory does not contain AGI files
AGIGame           OpenGameDIR               547       file access error while reading new wag file
AGIGame           OpenGameWAG               529       missing WAG file
AGIGame           OpenGameWAG               504       invalid or missing game directory
AGIGame           OpenGameWAG               539       WAG file is readonly
AGIGame           OpenGameWAG               540       file access error while opening WAG file
AGIGame           OpenGameWAG               530       invalid WAG file version
AGIGame           OpenGameWAG               538       invalid IntVersion in WAG file
AGIGame           OpenGameWAG               537       missing GameID in WAG file

AGILZW            ExpandV3ResData           509       inalid compression data

AGIResource       Clear                     501       resource not loaded
AGIResource       Data/get                  501       resource not loaded
AGIResource       EORes/get                 501       resource not loaded
AGIResource       Export                    501       resource not loaded
AGIResource       Export                    519       can't export resource that has errors
AGIResource       Export                    502       file access error while exporting resource
AGIResource       Import                    521       nothing to import
AGIResource       Import                    502       file access error while importing resource
AGIResource       InsertData                501       resource not loaded
AGIResource       Pos/get                   501       resource not loaded
AGIResource       Pos/set                   501       resource not loaded
AGIResource       ReadByte                  501       resource not loaded
AGIResource       ReadWord                  501       resource not loaded
AGIResource       RemoveData                501       resource not loaded
AGIResource       ReplaceData               501       resource not loaded
AGIResource       Save                      501       resource not loaded
AGIResource       WriteByte                 501       resource not loaded
AGIResource       WriteWord                 501       resource not loaded

AudioPlayer       Dispose                   526       media player error
AudioPlayer       PlayMIDISound             526       media player error
AudioPlayer       PlayMIDISound             526       media player error

Cel               AllCelData/set            524       array Width is invalid
Cel               AllCelData/set            524       array Height is invalid

Cels              Add                       508       invalid insert pos
Cels              Remove                    522       invalid remove pos

InventoryList     Add                       501       resource not loaded
InventoryList     Add                       512       too many inventory items
InventoryList     Clear                     501       resource not loaded
InventoryList     Clone                     501       resource not loaded
InventoryList     CloneFrom                 501       resource not loaded
InventoryList     Compile                   502       file access error while writing file
InventoryList     Encrypted/get             501       resource not loaded
InventoryList     Encrypted/set             501       resource not loaded
InventoryList     Export                    501       resource not loaded
InventoryList     Count/get                 501       resource not loaded
InventoryList     InUseCount/get            501       resource not loaded
InventoryList     MaxScreenObjects/get      501       resource not loaded
InventoryList     MaxScreenObjects/set      501       resource not loaded
InventoryList     Remove                    501       resource not loaded
InventoryList     Save                      501       resource not loaded
InventoryList     SetMSDOSFormat            502       file error converting from Amiga format

Logic             Clear                     501       resource not loaded
Logic             Clone                     501       resource not loaded
Logic             CloneFrom                 501       this resource not loaded
Logic             CloneFrom                 501       source resource not loaded
Logic             Compile                   501       resource not loaded
Logic             Compile                   525       compiling not allowed if not in game
Logic             Compile                   507       no source code (empty)
Logic             ExportSource              501       resource not loaded
Logic             ExportSource              502       file error during export
Logic             Save                      501       resource not loaded
Logic             SaveSource                502       file access error while writing source

Logics            Add                       520       resource number already in use
Logics            Renumber                  531       new number already in use

Loops             Remove                    523       can't remove last loop

Picture           VisData/get               501       resource not loaded
Picture           PriData/get               501       resource not loaded
Picture           CurrentToolStatus/get     501       resource not loaded
Picture           DrawPos/get               501       resource not loaded
Picture           DrawPos/set               501       resource not loaded
Picture           StepDraw/get              501       resource not loaded
Picture           StepDraw/set              501       resource not loaded
Picture           Clone                     501       resource not loaded
Picture           CloneFrom                 501       this resource not loaded
Picture           CloneFrom                 501       target resource not loaded
Picture           ObjOnWater                501       resource not loaded
Picture           ControlPixel              501       resource not loaded
Picture           VisPixel                  501       resource not loaded
Picture           PriPixel                  501       resource not loaded
Picture           PixelPri                  501       resource not loaded
Picture           Clear                     501       resource not loaded
Picture           Save                      501       resource not loaded

Pictures          Add                       520       picture already exists
Pictures          Renumber                  531       new number already in use

ResourceFunctions ExpandV3ResData           509       invalid compression data
ResourceFunctions ExtractResources          539       v3 DIR file is readonly
ResourceFunctions ExtractResources          541       file access error while reading v3 DIR file
ResourceFunctions ExtractResources          505       invalid v3 DIR file (too small)
ResourceFunctions ExtractResources          539       VOL.0 is readonly
ResourceFunctions ExtractResources          539       v2 DIR file is readonly
ResourceFunctions ExtractResources          541       file access error while reading v2 DIR file
ResourceFunctions ExtractResources          505       invalid v3 DIR file (bad offset/size)
ResourceFunctions ExtractResources          505       invalid v3 DIR file (bad offset)

SettingsFile      .ctor                     539       list file is readonly
SettingsFile      .ctor                     539       list file is readonly
SettingsFile      .ctor                     502       file access error while opening list file
SettingsFile      Save                      502       file access error while opening list file

Sound             Clear                     501       resource not loaded
Sound             Clone                     501       resource not loaded
Sound             CloneFrom                 501       this resource not loaded
Sound             CloneFrom                 501       target resource not loaded
Sound             CompileSound              511       error while compiling sound tracks
Sound             Export                    501       resource not loaded
Sound             ExportAsMIDI              542       wrong sound format
Sound             ExportAsScript            542       wrong sound format
Sound             ExportAsWAV               542       wrong sound format
Sound             PlaySound                 501       sound not loaded
Sound             Save                      501       resource not loaded
Sound             Tracks                    501       resource not loaded
Sound             WAVData/get               501       resource not loaded
Sound             WAVData/get               542       wrong format
Sound             MIDIData/get              501       resource not loaded
Sound             MIDIData/get              542       wrong format

SoundImport       ImportScript              532       invalid script data

Sounds            Add                       520       this index already exists
Sounds            Renumber                  531       new number already in use

View              this/get                  501       view not loaded
View              Loops/get                 501       view not loaded
View              ViewDescription/get       501       view not loaded
View              ViewDescription/set       501       view not loaded
View              Clone                     501       resource not loaded
View              CloneFrom                 501       this resource not loaded
View              CloneFrom                 501       target resource not loaded
View              Clear                     501       view not loaded
View              Export                    501       view not loaded
View              Save                      501       view not loaded

Views             Add                       520       this index already exists
Views             Renumber                  531       new number already in use

VOLManager        AddNextRes                528       file access error while writing to VOL file
VOLManager        FindFreeVOLSpace          517       no room for resource in VOL files
VOLManager        UpdateDirFile             539       DIR file is readonly
VOLManager        UpdateDirFile             541       file access error while reading DIR file
VOLManager        UpdateDirFile             541       file access error while writing DIR file
VOLManager        UpdateDirFile             541       file access error while creating DIR file
VOLManager        UpdateDirFile             541       file access error while writing DIR file
VOLManager        UpdateInVol               528       file access error while writing to VOL file
VOLManager        ValidateVolAndLoc         528       file access error while creating new VOL file
VOLManager        ValidateVolAndLoc         517       no room for resource in VOL files

WordList          this[index]/get           501       resource not loaded
WordList          this[key]/get             501       resource not loaded
WordList          AddGroup                  501       resource not loaded
WordList          AddWord                   501       resource not loaded
WordList          AddWord                   513       duplicate word
WordList          AddWord                   514       invalid group number
WordList          Clear                     501       resource not loaded
WordList          Clone                     501       resource not loaded
WordList          CloneFrom                 501       this resource not loaded
WordList          CloneFrom                 501       target resource not loaded
WordList          Compile                   502       file access error while writing data
WordList          CompileSVE                502       file access error while writing data
WordList          Export                    501       resource not loaded
WordList          Export[SVE]               501       resource not loaded
WordList          Group                     501       resource not loaded
WordList          GroupCount/get            501       resource not loaded
WordList          GroupExists               501       resource not loaded
WordList          GroupN                    501       resource not loaded
WordList          IsChanged/get             501       resource not loaded
WordList          RemoveGroup               501       resource not loaded
WordList          RemoveGroup               515       group number does not exist
WordList          RemoveWord                501       resource not loaded
WordList          RemoveWord                516       word does not exist
WordList          RenumberGroup             501       resource not loaded
WordList          Save                      501       resource not loaded
WordList          WordCount/get             501       resource not loaded
WordList          WordExists                501       resource not loaded

Common            CopyDirectory             548       unable to copy directory



Menu Structures
=========================================================================
MDIMain
mnuResources
    mnuRNew
        mnuRNLogic
        mnuRNPicture
        mnuRNSound
        mnuRNView
        toolStripSeparator6 
        mnuRNObjects
        mnuRNWords
        toolStripSeparator5 
        mnuRNText
    mnuROpen
        mnuROLogic
        mnuROPicture
        mnuROSound
        mnuROView
        toolStripSeparator13 
        mnuROObjects
        mnuROWords
        toolStripSeparator14 
        mnuROText
    mnuRImport
        mnuRILogic
        mnuRIPicture
        mnuRISound
        mnuRIView
        toolStripSeparator15 
        mnuRIObjects
        mnuRIWords
    mnuRSep1 
    mnuROpenRes
    mnuRSave
    mnuRExport
    mnuRSep2 
    mnuRRemove
    mnuRRenumber
    mnuRProperties
    mnuRSep3 
    mnuRCompileLogic
    mnuRSavePicImage
    mnuRExportGIF

Editors:
!!! merging menu separators does not work as expected - 
no matter what is specified for MergeIndex, only the first
separator gets replaced; so instead of merging, the
separators are left in place and Visible property is set
as needed to manage them
frmGlobals
----------
      mnuResources
      0   mnuRNew ...
      1   mnuROpen ...
      2   mnuRImport ...
      3   mnuRSep1 
      4 - mnuROpenRes
      4 r mnuRSave
      5 r mnuRExport -> mnuRSaveAs
      6 S mnuRSep2 
      7 r mnuRRemove -> mnuRInGame
      8 - mnuRRenumber
      8 - mnuRProperties
      8 S mnuRSep3 
      9 - mnuRCompileLogic
      9 - mnuRSavePicImage
      9 - mnuRExportGIF
     -1 + mnuAddFile
 
frmLayout
---------
      mnuResources
      0   mnuRNew ...
      1   mnuROpen ...
      2   mnuRImport ...
      3   mnuRSep1 
      4 - mnuROpenRes
      4 r mnuRSave
      5 - mnuRExport
      5 S mnuRSep2 
      6 - mnuRRemove
      6 - mnuRRenumber
      6 - mnuRProperties
      6 H mnuRSep3 
      7 - mnuRCompileLogic
      7 - mnuRSavePicImage
      7 - mnuRExportGIF
     -1 + mnuRepair
     -1 + mnuToggleAllPics

frmLogicEdit
------------
      mnuResources
      0   mnuRNew ...
      1   mnuROpen ...
      2   mnuRImport ...
      3   mnuRSep1 
      4 - mnuROpenRes
      4 r mnuRSave
      5 r mnuRExport
      6 S mnuRSep2 
      7 r mnuRRemove -> mnuRInGame
      8 r mnuRRenumber
      9 r mnuRProperties
     10 S mnuRSep3 
     11 r mnuRCompileLogic -> mnuCompile
     12 - mnuRSavePicImage
     12 - mnuRExportGIF
     -1 + mnuRMsgCleanup
     -1 + mnuRIsRoom 

frmMenuEdit
-----------
      mnuResources
      0   mnuRNew ...
      1   mnuROpen ...
      2   mnuRImport ...
      3   mnuRSep1 
      4 - mnuROpenRes
      4 r mnuRSave
      5 r mnuRExport
      6 S mnuRSep2 
      7 - mnuRRemove
      7 - mnuRRenumber
      7 - mnuRProperties
      7 H mnuRSep3 
      8 - mnuRCompileLogic
      8 - mnuRSavePicImage
      8 - mnuRExportGIF
     -1 + mnuBackground
     -1 + mnuHotKeyAlign

frmObjectEdit
-------------
      mnuResources
      0   mnuRNew ...
      1   mnuROpen ...
      2   mnuRImport ...
      3   mnuRSep1 
      4 - mnuROpenRes
      4 r mnuRSave
      5 r mnuRExport
      6 S mnuRSep2 
      7 - mnuRRemove
      7 - mnuRRenumber
      7 r mnuRProperties
      8 S mnuRSep3 
      9 - mnuRCompileLogic
      9 - mnuRSavePicImage
      9 - mnuRExportGIF
        + mnuRToggleEncrypt
        + mnuRAmigaOBJ

frmPicEdit
----------
      mnuResources
      0   mnuRNew ...
      1   mnuROpen ...
      2   mnuRImport ...
      3   mnuRSep1 
      4 - mnuROpenRes
      4 r mnuRSave
      5 r mnuRExport
      6 S mnuRSep2 
      7 r mnuRRemove -> mnuRInGame
      8 r mnuRRenumber
      9 r mnuRProperties
     10 S mnuRSep3 
     11 - mnuRCompileLogic
     11 r mnuRSavePicImage
     12 r mnuRExportGIF

frmPreview
----------
  same as main form

frmSoundEdit
------------
      mnuResources
      0   mnuRNew ...
      1   mnuROpen ...
      2   mnuRImport ...
      3   mnuRSep1 
      4 - mnuROpenRes
      4 r mnuRSave
      5 r mnuRExport
      6 S mnuRSep2 
      7 r mnuRRemove -> mnuRInGame
      8 r mnuRRenumber
      9 r mnuRProperties
     10 S mnuRSep3 
     11 - mnuRCompileLogic
     11 - mnuRSavePicImage
     11 - mnuRExportGIF
        + mnuRPlaySound
        + mnuRPlaybackMode
        

frmTextScreenEdit
-----------------
      mnuResources
      0   mnuRNew ...
      1   mnuROpen ...
      2   mnuRImport ...
      3   mnuRSep1
      4 r mnuROpenRes -> mnuOpen
      5 r mnuRSave
      6 r mnuRExport -> mnuRSaveAs
      7 H mnuRSep2 
      8 - mnuRRemove
      8 - mnuRRenumber
      8 - mnuRProperties
      8 H mnuRSep3 
      9 - mnuRCompileLogic
      9 - mnuRSavePicImage
      9 - mnuRExportGIF

frmViewEdit
-----------
      mnuResources
      0   mnuRNew ...
      1   mnuROpen ...
      2   mnuRImport ...
      3   mnuRSep1 
      4 - mnuROpenRes
      4 r mnuRSave
      5 r mnuRExport
      6 S mnuRSep2 
      7 r mnuRRemove -> mnuRInGame
      8 r mnuRRenumber
      9 r mnuRProperties
     10 S mnuRSep3 
     11 - mnuRCompileLogic
     11 - mnuRSavePicImage
     11 r mnuRExportGIF =>mnuRExportLoopGIF

frmWordEdit
-----------
      mnuResources
      0   mnuRNew ...
      1   mnuROpen ...
      2   mnuRImport ...
      3   mnuRSep1 
      4 - mnuROpenRes
      4 r mnuRSave
      5 r mnuRExport
      6 S mnuRSep2 
      7 - mnuRRemove
      7 - mnuRRenumber
      7 r mnuRProperties
      8 S mnuRSep3 
      9 - mnuRCompileLogic
      9 - mnuRSavePicImage
      9 - mnuRExportGIF
        + mnuRMerge
        + mnuRGroupCheck



events that should update main toolbar buttons:
  open game/new game:
    close game btn
    run btn
    import btn
    layouted btn

  close game
    close game btn
    run btn
    import btn
    layouted btn


  activate editor
    save btn,
    ingame btn,
    export btn,


  editor changes:
    save btn - ischanged status
    ingame btn - lpsv ingame status

btns:
A  opengame
g  closegame
g  rungame

A  newres   
A  openres
g  importres

A  worded
A  objected

   saveres
   ingame
   exportres

g  layouted
A  menued
A  txtscreened
A  globaled

A  help


Syntax highlighting notes:
===========================================================================================================
white space: any char <= 33

single char operators:
!   &   '   (   )   *   +   ,   -   .   /   :   ;   >   =   <   ?   @   \   ]   ^   `   {    |    }    ~
33, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 58, 59, 60, 61, 62, 63, 64, 92, 93, 94, 96, 123, 124, 125, 126

double char operators:
   !=  &&  *=  ++  +=  --  -=  /= >=  ><  ==  =<  =>  =@  <=  <>  || @=

numbers:
48-57

strings:
    ""
    "*"
    "*
     where * = anything else
when inside a string \" is not a quote (if preceded by two slashes it should count)
34

comments:
starts with [ or //
91, 47

keywords:
#define, #include, #message, if, else, goto

commands (test, action, invalid):
from list

argument identifiers:
v#, f#, s#, c#, i#, m#, o#


defined names/tokens:
starts with: 
    letter-underscore(\w) or extended char or $ or # or %
    (cannot start with number or '.')
ends if NOT:
    letter-number-underscore(\w) or extended char or $ or # or % or .


WinAGI settings and warnings:
// ************************************************
// WARNINGS
// ************************************************
// RenameWAG
// OpenNew
// AskExport
// AskRemove
// AutoUpdateDefines
// AutoUpdateResDefs
// AutoUpdateWords
// AutoUpdateObjects
// WarnDupGName
// WarnDupGVal
// WarnInvalidStrVal
// WarnInvalidCtlVal
// WarnResOverride
// WarnDupObj
// WarnCompile
// DelBlankG
// NotifyCompSuccess
// NotifyCompWarn
// NotifyCompFail
// WarnItem0
// OpenOnErr
// SaveOnCompile
// CompileOnRun
// WarnMsgs
// WarnEncrypt
// LEDelPicToo
// //WarnPlotPaste

// ************************************************
// GENERAL SETTINGS
// ************************************************
// ShowSplashScreen
// ShowPreview
// ShiftPreview
// HidePreview
// ResListType
// AutoExport
// BackupResFile
// DefMaxSO
// DefMaxVol0
// DefCP
// DefResDir

// ************************************************
// MRU SETTINGS
// ************************************************
// AutoOpen

// ************************************************
// RESOURCE TREE LABEL FORMAT
// ************************************************
// ShowResNum
// IncludeResNum
// ResFormatNameCase
// ResFormatSeparator
// ResFormatNumFormat

// ************************************************
// LOGIC SETTINGS
// ************************************************
// AutoWarn
// HighlightLogic
// HighlightText
// LogicTabWidth
// MaximizeLogics
// AutoQuickInfo
// ShowDefTips
// ShowDocMap
// ShowLineNumbers
// DefaultExt
// EditorFontName
// EditorFontSize
// PreviewFontName
// PreviewFontSize
// ErrorLevel
// DefIncludeIDs
// DefIncludeReserved
// DefIncludeGlobal
// UseSnippets

// ************************************************
// SYNTAX HIGHLIGHT SETTINGS
// ************************************************
// EditorBackColor
// EditorForeColor
// EditorDefaultFontStyle
// SyntaxStyle[10]

// ************************************************
// LOGIC DECOMPILER SETTINGS
// ************************************************
// MsgsByNumber
// IObjsByNumber
// WordsByNumber
// ShowAllMessages
// SpecialSyntax
// ReservedAsText
// CodeStyle

// ************************************************
// PICTURE SETTINGS
// ************************************************
// ShowBands
// SplitWindow
// PicScalePreview
// PicScaleEdit
// CursorMode

// ************************************************
// PICTURETEST SETTINGS
// ************************************************
// PicTest.ObjSpeed
// PicTest.ObjPriority
// PicTest.ObjRestriction
// PicTest.Horizon
// PicTest.IgnoreHorizon
// PicTest.IgnoreBlocks
// PicTest.CycleAtRest

// ************************************************
// SOUND SETTINGS
// ************************************************
// PlaybackMode
// ShowKybd
// ShowNotes
// OneTrack
// DefInst
// DefMute
// SndZoom

// ************************************************
// VIEW SETTINGS
// ************************************************
// ShowVEPreview
// DefPrevPlay
// ShowGrid
// ViewAlignH
// ViewAlignV
// DefCelH
// DefCelW
// ViewScalePreview
// ViewScaleEdit
// DefVColor1
// DefVColor2

// ************************************************
// OBJECT SETTINGS
// ************************************************
// none

// ************************************************
// WORDS.TOK SETTINGS
// ************************************************
// none

// ************************************************
// LAYOUT EDITOR SETTINGS
// ************************************************
// DefUseLE
// LEUseGrid
// LEGridMinor
// LEGridMajor
// LEShowGrid
// LEShowPics
// LESync
// LEScale
// RoomEdgeColor
// RoomFillColor
// TransPtEdgeColor
// TransPtFillColor
// CmtEdgeColor
// CmtFillColor
// ErrPtEdgeColor
// ErrPtFillColor
// ExitEdgeColor
// ExitOtherColor


// ************************************************
// GLOBALS EDITOR SETTINGS
// ************************************************
// GEShowComment
// GENameFrac
// GEValFrac


// ************************************************
// MENU EDITOR SETTINGS (store in GENERAL)
// ************************************************
// AutoAlignHotKey


// ************************************************
// PLATFORM SETTINGS
// ************************************************
// AutoFill
// PlatformType
// PlatformFile
// DOSExec
// PlatformOpts



DECOMPILE STYLES
default:
if (test())
    {
    action();
    }
else
    {
    }

alternate 1:  (my preferred)
if (test()) {
    action();
}
else {
    action();
}

alternate 2: (another option)
if (test()) {
    action();
} else {
    action();
}

Status Bars:
=========================================================================

Statusbar merging in C# SUCKS!
    - it's not automatic,
    - and MOST ANNOYINGLY, it merges based on text, not on name so items
      often get mixed up due to text being the same on different forms

after many failed attempts to manage merging, I'm giving up. So only one
statusstrip on MdiMain form, and all status items will be added to that 
panel as needed based on which form is active

MDIMain:
  spStatus    [0] (spring, flat)
  spCapsLock  [1] (SunkenInside)
  spNumLock   [2] (SunkenInside)
  spInsLock   [3] (SunkenInside)

frmGlobalEdit:
    spStatus -> Inherit[0]
    spCapsLock -> Inherit[1]
    spNumLock -> Inherit[2]
    spInsLock -> Inherit[3]

frmLayout:
    spScale -> Insert[0]
    spTool -> Insert[1]
    spID -> Insert[2]
    spType -> Insert[3]
    spRoom1 -> Insert[4]
    spRoom2 -> Insert[5]
    spStatus -> Inherit[6]
    spCurX -> Insert[7]
    spCurY -> Insert[8]
    spCapsLock -> Hide
    spNumLock -> Hide
    spInsLock -> Hide

frmLogicEdit:
    spStatus -> Inherit[0]
    spLine (SunkenInside) -> Insert[1]
    spColumn (SunkenInside) -> Insert[2]
    spCapsLock Inherit [3]
    spNumLock  Inherit [4]
    spInsLock  Inherit [5]

frmMenuEdit:
    spStatus -> Inherit[0]
    spCapsLock -> Inherit[1]
    spNumLock -> Inherit[2]
    spInsLock -> Inherit[3]

frmObjectEdit:
    spCount -> Insert[0]
    spEncrypt -> Insert[1]
    spStatus -> Inherit[2]
    spCapsLock -> Inherit[3]
    spNumLock -> Inherit[4]
    spInsLock -> Inherit[5]

frmPicEdit:
    spScale -> Insert[0]
    spMode -> Insert[1]
    spTool -> Insert[2]
    spAnchor -> Insert[3]
    spBlock -> Insert[4]
    spStatus -> Inherit[5]
    spCurX -> Insert[6]
    spCurY -> Insert[7]
    spPriBand -> Insert[8]
    spCapsLock -> Hide
    spNumLock -> Hide
    spInsLock -> Hide

frmPreview:
    spStatus -> Inherit[0]
    spCapsLock -> Inherit[1]
    spNumLock -> Inherit[2]
    spInsLock -> Inherit[3]

frmSoundEdit:
    spScale -> Insert[0]
    spTime -> Insert[1]
    spStatus -> Inherit[2]
    spCapsLock -> Hide
    spNumLock -> Hide
    spInsLock -> Hide

frmTextScreenEdit:
    spScale -> Insert[0]
    spStatus -> Inherit[1]
    spMode -> Insert[2]
    spRow -> Insert[3]
    spCol -> Insert[4]
    spCapsLock -> Inherit[5]
    spNumLock -> Inherit[6]
    spInsLock -> Inherit[7]

frmViewEdit:
    spScale -> Insert[0]
    spTool -> Insert[1]
    spStatus -> Inherit[2]
    spCapsLock -> Hide
    spNumLock -> Hide
    spInsLock -> Hide

frmWordsEdit:
    spGroupCount -> Insert[0]
    spWordCount -> Insert[1]
    spStatus -> Inherit[2]
    spCapsLock -> Inherit[3]
    spNumLock -> Inherit[4]
    spInsLock -> Inherit[5]



status bar events:
mousedown - cache mouse position
PanelClick:
  frmPreview, frmLogicEdit - panel.key = 'Status'
       if panel.text is 'Error -...', clicking displays entire error in MsgBoxEX with help
       if not 'error', just show a msgbox

  frmPictureEdit:
       panel = scale, adjust pic scale up/down for left/right button
               anchor= popup anchor copy menu
               block= popup block copy menu
  
  frmSoundEdit:
       panel = scale, adjust zoom
  
  frmViewEdit:
       panel = scale, adjust zoom
      
  frmLayout:
       panel = scale, adjust zoom
Panel double-click
   frmObjectEdit, if panel = 'encrypt', toggle encryption




| GDI Function      | C# Equivalent (System.Drawing)         |
|-------------------|----------------------------------------| 
| BitBlt            | Graphics.DrawImage                     | 
| StretchBlt        | Graphics.DrawImage with scaling        | 
| TransparentBlt    | Graphics.DrawImage + ImageAttributes.SetColorKey |
| AlphaBlend        | Graphics.DrawImage + ImageAttributes.SetColorMatrix |
---

| GDI Classic (BitBlt/ROP)  | System.Drawing Equivalent       |
|---------------------------|---------------------------------|
| ROP codes (SRCCOPY, etc)  | Not supported                   |
| Alpha blending            | CompositingMode/ImageAttributes |
| Color key transparency    | ImageAttributes.SetColorKey     |
| Custom raster ops         | P/Invoke GDI or manual pixels   |

Layout File Format:
Header: Name, Version, DrawScale, Offset
0x01 character separates element blocks
element block types:
    Room: ShowPic, Loc, Exits[ID, OldRoom, Reason, Style, Transfer, Leg, Status], Index, Visible
    TransPt: Loc[2], Rooms[2], ID[2], Count, Index, Visible
    ErrPt: Loc, Room, ExitID, FromRoom, Index, Visible
    Comment: Loc, Size, Text, Index, Visible
0x02 character separates modification blocks
modification block types
    Renumber: OldNumber, Index, Visible
    Update: ShowPic, Exits[ID, OldRoom, Reason, Style, Transfer, Leg, Status], Index, Visible
    Show: ShowPic, Exits[ID, OldRoom, Reason, Style, Transfer, Leg, Status], Index, Visible
    Hide: Index", Visible
each block is a json serialized object